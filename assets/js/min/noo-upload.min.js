!function(e){e.fn.noo_upload_form=function(i){function a(i){var i=e(i);i.find(".upload-show-more").on("click",function(a){a.preventDefault(),e("body").addClass("noo-cover-body"),i.find(".noo-upload-left").addClass("upload-show-box-more"),i.find(".owl-wrapper").append('<i class="upload-close-more fa fa-times"></i>'),i.on("click",".upload-close-more",function(a){a.preventDefault(),e("body").removeClass("noo-cover-body"),i.find(".noo-upload-left").removeClass("upload-show-box-more"),e(this).remove()})})}var o={max_file_size:"10mb",runtimes:"html5,flash,silverlight,html4",multi_upload:!0,browse_button:"pickfiles",container:"noo-upload-wrap",name:"noo-upload-form",allow_format:"jpg,jpeg,gif,png",multi_input:!1,drop_element:"",set_featured:!1,slider:!0};i=e.extend(o,i);var t=(e(this),new plupload.Uploader({runtimes:i.runtimes,browse_button:i.browse_button,container:document.getElementById(i.container),multi_upload:i.multi_upload,url:NooUpload.ajax_url,file_data_name:"noo-upload-form",filters:{max_file_size:i.max_file_size,mime_types:[{title:"",extensions:i.allow_format}]},views:{list:!0,thumbs:!0,active:"thumbs"},dragdrop:!0,multiple_queues:!0,urlstream_upload:!0,multipart:!0,multi_selection:!1,flash_swf_url:NooUpload.flash_swf_url,silverlight_xap_url:NooUpload.silverlight_xap_url,multipart_params:{security:NooUpload.security,action:"noo_upload_form"},drop_element:i.drop_element,init:{PostInit:function(){if(i.slider){e("#"+i.container).find(".process-upload-media").html("");{e("#"+i.container).find(".noo-list-image").owlCarousel({items:3,navigation:!0,pagination:!1,mouseDrag:!1,touchDrag:!1,navigationText:['<i class="fa fa-angle-left"></i>','<i class="fa fa-angle-right"></i>']})}e("#"+i.container).on("click",".noo-upload-image",function(){return t.start(),!1});var o=e("#"+i.container).find(".noo-list-image").find(".owl-item").length;o>3?(e("#"+i.container).find(".upload-show-more").show(),a("#"+i.container)):e("#"+i.container).find(".upload-show-more").hide(),e("#"+i.container).on("click",".remove-item",function(a){a.preventDefault(),e(this).closest(".owl-item").remove(),1>o?e("#"+i.container).find(".noo-drop-file").show():e("#"+i.container).find(".noo-drop-file").hide();var t=e(this),n=parseInt(t.data("id")),d=parseInt(e("body").find("#set_featured").val());if("undefined"!=typeof n&&""!==n){var s={action:"noo_remove_media",security:NooUpload.security,id:n};e.post(NooUpload.ajax_url,s,function(a){"success"===a.status&&(e("#"+i.container).find("input.value-image-"+n).remove(),"undefined"!=typeof d&&d==n&&e("body").find("#set_featured").val("")),e("#"+i.container).find(".process-upload-media").html(a.msg),setTimeout(function(){e("#"+i.container).find(".process-upload-media").html("").hide("400")},2e3)})}}),e("#"+i.container).on("click",".set-featured",function(a){a.preventDefault();var o=e(this),t=parseInt(o.data("id")),n=parseInt(e("body").find("#set_featured").val()),d='<i class="item-featured fa fa-star"></i>';o.addClass("active"),e("#"+i.container).find(".item-featured").remove(),o.closest(".item-image").append(d),"undefined"!=typeof n&&n!==t&&e("body").find("#set_featured").val(t)}),e(".noo-list-image").sortable({cursor:"move",items:".owl-item",stop:t.updateOrder})}},FilesAdded:function(a,o){i.slider?plupload.each(o,function(o){var n=o.type,d=noo_img_upload.file_ext_thumbnail;if("image/png"===n||"image/jpeg"===n){var s=new mOxie.Image;s.onload=function(){e("#"+i.container).find(".preview").empty(),this.embed(e("#"+i.container).find(".preview").get(0),{width:150,height:150})},s.onembedded=function(){this.destroy()},s.onerror=function(){this.destroy()},s.load(o.getSource()),s.onembedded=function(){var t=e("#"+i.container).find(".preview").find("canvas")[0].toDataURL();"undefined"!=typeof t||""!==url?e("#"+i.container).find(".noo-drop-file").hide():e("#"+i.container).find(".noo-drop-file").show();var n='<div class="item-image" id="item-image-'+r+'"><img src="'+t+'"><i class="remove-item fa fa-trash-o"></i></div>';e("#"+i.container).find(".noo-list-image").data("owlCarousel").addItem(n,0),e("#"+i.container).on("click",".remove-item",function(t){t.preventDefault(),a.removeFile(o),e(this).closest(".owl-item").remove();var n=e("#"+i.container).find(".noo-list-image").find(".owl-item").length;1>n?e("#"+i.container).find(".noo-drop-file").show():e("#"+i.container).find(".noo-drop-file").hide();var d=e(this),s=parseInt(d.data("id")),l=parseInt(e("body").find("#set_featured").val());if("undefined"!=typeof s&&""!==s){var r={action:"noo_remove_media",security:NooUpload.security,id:s};e.post(NooUpload.ajax_url,r,function(a){"success"===a.status&&(e("#"+i.container).find("input.value-image-"+s).remove(),"undefined"!=typeof l&&l==s&&e("body").find("#set_featured").val("")),e("#"+i.container).find(".process-upload-media").html(a.msg),setTimeout(function(){e("#"+i.container).find(".process-upload-media").html("").hide("400")},2e3)})}})}}else{"undefined"!=typeof d||""!==url?e("#"+i.container).find(".noo-drop-file").hide():e("#"+i.container).find(".noo-drop-file").show();var l='<div class="item-image" id="item-image-'+o.id+'"><img src="'+d+'"><i class="remove-item fa fa-trash-o"></i></div>';e("#"+i.container).find(".noo-list-image").data("owlCarousel").addItem(l,0)}var r=o.id;e("#"+i.container).on("click",".set-featured",function(a){a.preventDefault();var o=e(this),t=parseInt(o.data("id")),n=parseInt(e("body").find("#set_featured").val()),d='<i class="item-featured fa fa-star"></i>';o.toggleClass("active"),e("#"+i.container).find(".item-featured").remove(),o.closest(".item-image").append(d),"undefined"!=typeof n&&n!==t&&e("body").find("#set_featured").val(t)}),t.start()}):t.start()},UploadProgress:function(a,o){if(i.slider){{var t=a.total.uploaded,n=(a.total.failed,a.files.length);a.getOption("filters").max_file_count||0}e("#"+i.container).find(".process-upload-media").show().html("Uploaded "+t+"/"+n+" files - ( "+plupload.formatSize(o.size)+" )")}},UploadComplete:function(){i.slider&&(e("#"+i.container).find(".process-upload-media").html("Upload Success!!!"),setTimeout(function(){e("#"+i.container).find(".process-upload-media").html("").hide("400")},2e3))},Error:function(a,o){e("#"+i.container).find(".process-upload-media").html("\nError #"+o.code+": "+o.message)},FileUploaded:function(o,n,d){if(i.slider){e("#"+i.container).find(".process-upload-media").html("");var s=e.parseJSON(d.response),l="",r=i.name.split("|"),u=n.id,f="item-image-"+u;if(i.multi_input?e.each(r,function(e){l+=i.multi_upload?'<input type="hidden" name="'+r[e]+'[]" value="'+s.id+'" class="value-image-'+s.id+'" />':'<input type="hidden" name="'+r[e]+'" id="'+r+'" value="'+s.id+'" class="value-image-'+s.id+'" />'}):l+=i.multi_upload?'<input type="hidden" class="'+i.name+" value-image-"+s.id+'" name="'+i.name+'[]"  value="'+s.id+'" />':'<input type="hidden" class="'+i.name+" value-image-"+s.id+'" name="'+i.name+'"  value="'+s.id+'"/>',"success"==s.status){var m="",c="",p=noo_img_upload.file_ext_thumbnail,v=n.type;i.set_featured&&(m='<i class="set-featured fa fa-star" data-id="'+s.id+'"></i>',c="featured");var h='<i class="remove-item fa fa-trash-o" data-id="'+s.id+'"></i>';e("#"+i.container).find("#"+f).length>0&&("image/jpeg"===v||"image/png"===v?e("#"+i.container).find("#"+f).addClass(c).html('<i class="success fa fa-check-circle-o"></i><img src="'+s.url+'">'+m+h+l):e("#"+i.container).find("#"+f).addClass(c).html('<i class="success fa fa-check-circle-o"></i><img src="'+p+'">'+m+h+l)),console.log(s.url),i.multi_upload}else e("#"+i.container).find(".noo-thumbnail-process").html(s.msg);e(".noo-list-image").sortable({cursor:"move",items:".owl-item",stop:t.updateOrder}),a("#"+i.container)}else{var s=e.parseJSON(d.response);"success"==s.status&&e("#"+i.container).find(".noo-upload-thumbnail").html('<img src="'+s.url+'" /><input type="hidden" class="'+i.name+" value-image-"+s.id+'" name="'+i.name+'"  value="'+s.id+'"/>')}}}}));t.init()}}(jQuery);
function noo_number_format(e,a,o,t){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var n,r,i,s=isFinite(+e)?+e:0,p=isFinite(+a)?Math.abs(a):0,l=void 0===t?",":t,m=void 0===o?".":o,c="";return 3<(c=(p?(n=s,r=p,i=Math.pow(10,r),""+(Math.round(n*i)/i).toFixed(r)):""+Math.round(s)).split("."))[0].length&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,l)),(c[1]||"").length<p&&(c[1]=c[1]||"",c[1]+=new Array(p-c[1].length+1).join("0")),c.join(m)}var infoBox,map,mapSearchBox,mcluster,gmarkers=[],gmarker_index=1;!function(w){"use strict";function a(e){15!=map.getZoom()&&map.setZoom(15);var a=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);map.setCenter(a);new google.maps.Marker({position:a,map:map,icon:nooGmapL10n.theme_uri+"/assets/images/my-marker.png",shape:{coord:[1,1,1,38,38,59,59,1],type:"poly"},zIndex:9999,infoWindowIndex:9999,radius:1e3});var o={strokeColor:"#75b08a",strokeOpacity:.6,strokeWeight:1,fillColor:"#75b08a",fillOpacity:.2,map:map,center:a,radius:1e3};new google.maps.Circle(o)}function o(){alert(nooGmapL10n.no_geolocation_pos)}function n(e){var a=e.serializeArray(),o={};return w.map(a,function(e,a){o[e.name]=e.value}),o}function P(){var e=w(".noo_advanced_search_property .idx"),a=w(".noo_advanced_search_property .property"),o=nooGmapL10n.custom_fields;if("1"==e.length)var n={form_map:"",city:"",bedrooms:NaN,bathrooms:NaN,min_price:NaN,max_price:NaN,sqft:NaN};if("1"==a.length){n={form_map:"",location:"",sub_location:"",status:"",category:"",bedrooms:NaN,agent_search:NaN,bathrooms:NaN,min_price:NaN,max_price:NaN,min_area:NaN,max_area:NaN};w.extend(n,nooGmapL10n.custom_fields)}if(!w("#gmap").length)return n;var r=w(".noo_advanced_search_property .gsearch");return"1"==e.length&&(n.form_map="idx",n.city=0<e.find("input#idx-q-Cities").length?e.find("input#idx-q-Cities").val():"",n.bedrooms=0<e.find("input#idx-q-BedsMin").length?parseInt(e.find("input#idx-q-BedsMin").val()):NaN,n.bathrooms=0<e.find("input#idx-q-BathsMin").length?parseInt(e.find("input#idx-q-BathsMin").val()):NaN,n.min_price=0<e.find("input#idx-q-PriceMin").length?parseInt(e.find("input#idx-q-PriceMin").val()):NaN,n.max_price=0<e.find("input#idx-q-PriceMax").length?parseInt(e.find("input#idx-q-PriceMax").val()):NaN,n.sqft=0<e.find("input#idx-q-ImprovedSqFtMin").length?parseInt(e.find("input#idx-q-ImprovedSqFtMin").val()):NaN),"1"==a.length&&r.length&&(n.form_map="property",n.location=0<r.find('[name="location"]').length?r.find('[name="location"]').val():"",n.sub_location=0<r.find('[name="sub_location"]').length?r.find('[name="sub_location"]').val():"",n.status=0<r.find('[name="status"]').length?r.find('[name="status"]').val():"",n.category=0<r.find('[name="category"]').length?r.find('[name="category"]').val():"",n.bedrooms=0<r.find('[name="bedrooms"]').length?parseInt(r.find('[name="bedrooms"]').val()):NaN,n.agent_search=0<r.find('[name="agent_search"]').length?parseInt(r.find('[name="agent_search"]').val()):NaN,n.bathrooms=0<r.find('[name="bathrooms"]').length?parseInt(r.find('[name="bathrooms"]').val()):NaN,n.min_price=0<r.find('[name="min_price"]').length?parseFloat(r.find('[name="min_price"]').val()):NaN,n.max_price=0<r.find('[name="max_price"]').length?parseFloat(r.find('[name="max_price"]').val()):NaN,n.min_area=0<r.find('[name="min_area"]').length?parseInt(r.find('[name="min_area"]').val()):NaN,n.max_area=0<r.find('[name="max_area"]').length?parseInt(r.find('[name="max_area"]').val()):NaN,w.each(o,function(e,a){var o="_noo_property_field_"+e;if(0<r.find('[name="'+o+'"]').length){var t=r.find('[name="'+o+'"]').val();0<r.find('input[name="'+o+'"]:checked').length&&(t=r.find('[name="'+o+'"]:checked').val()),n[e]=t}if(0<r.find('input[name="'+o+'[]"]:checkbox:checked').length){t=r.find('input[name="'+o+'[]"]:checkbox:checked').map(function(){return w(this).val()}).get();n[e]=t}if(0<r.find('[name="'+o+'[]"] :selected').length){t=[];r.find('[name="'+o+'[]"] :selected').each(function(e,a){t[e]=w(a).val()}),console.log("Checkbox: "+t),n[e]=t}})),n}function M(n,r){if(null==n||void 0===n)return!1;if(null==r||void 0===r)return!1;if("idx"==r.form_map){if(!isNaN(r.bedrooms)&&n.bedrooms!==parseInt(r.bedrooms))return n.setVisible(!1),!1;if(!isNaN(r.bathrooms)&&n.bathrooms!==parseInt(r.bathrooms))return n.setVisible(!1),!1;if(!isNaN(r.min_price)&&parseFloat(n.price)<parseFloat(r.min_price))return n.setVisible(!1),!1;if(!isNaN(r.max_price)&&parseFloat(n.price)>parseFloat(r.max_price))return n.setVisible(!1),!1}if("property"==r.form_map){if(""!=r.location&&-1==n.location.indexOf(r.location))return n.setVisible(!1),!1;if(""!=r.sub_location&&-1==n.sub_location.indexOf(r.sub_location))return n.setVisible(!1),!1;if(""!=r.status&&-1==n.status.indexOf(r.status))return n.setVisible(!1),!1;if(""!=r.category&&-1==n.category.indexOf(r.category))return n.setVisible(!1),!1;if(""!=r.bedrooms&&!isNaN(r.bedrooms)&&n.bedrooms!==r.bedrooms)return n.setVisible(!1),!1;if(""!=r.agent_search&&!isNaN(r.agent_search)&&n.agent_search!==r.agent_search)return n.setVisible(!1),!1;if(""!=r.bathrooms&&!isNaN(r.bathrooms)&&n.bathrooms!==r.bathrooms)return n.setVisible(!1),!1;if(""!=r.min_price&&!isNaN(r.min_price)&&parseFloat(n.price)<r.min_price)return n.setVisible(!1),!1;if(""!=r.max_price&&!isNaN(r.max_price)&&parseFloat(n.price)>r.max_price)return n.setVisible(!1),!1;if(""!=r.min_area&&!isNaN(r.min_area)&&parseInt(n.area)<r.min_area)return n.setVisible(!1),!1;if(""!=r.max_area&&!isNaN(r.max_area)&&parseInt(n.area)>r.max_area)return n.setVisible(!1),!1;var i=!1;if(w.each(r,function(o,e){if(""!==r[o]&&"undefined"!==w.type(n[o])&&(isNaN(r[o])?"string"===w.type(r[o])&&"array"!==w.type(n[o])&&(console.log(o+":"+r[o]+" - "+n[o]+" --- "+w.type(r[o])+" --- "+w.type(n[o])),r[o]!==n[o]&&(n.setVisible(!1),i=!0)):r[o]!==n[o]&&""!=r[o]&&0!=r[o]&&(n.setVisible(!1),i=!0),w.isArray(r[o]))){var t=r[o];w.each(t,function(e,a){-1==w.inArray(t[e],n[o])&&(console.log(o+": "+r[o]+" --- "+n[o]+" --- "+w.type(r[o])+" --- "+w.type(n[o])),n.setVisible(!1),i=!0)})}}),i)return n.setVisible(!1),!1}return n.setVisible(!0),!0}google.maps.event.addDomListener(window,"load",function(){var e=(mapSearchBox=w(".noo-map")).find("#gmap"),a=nooGmapL10n.latitude,o=nooGmapL10n.longitude;if(mapSearchBox.length&&e.length){var t=new google.maps.LatLng(a,o),n={flat:!1,noClear:!1,zoom:parseInt(nooGmapL10n.zoom),scrollwheel:!1,streetViewControl:!1,disableDefaultUI:!0,draggable:!Modernizr.touch&&nooGmapL10n.draggable,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(e.get(0),n),google.maps.visualRefresh=!0,google.maps.event.addListener(map,"tilesloaded",function(){mapSearchBox.find(".gmap-loading").hide()});var r=document.getElementById("gmap_search_input");map.controls[google.maps.ControlPosition.TOP_LEFT].push(r);var i=new google.maps.places.SearchBox(r);google.maps.event.addListener(i,"places_changed",function(){var e=i.getPlaces();if(0!=e.length){for(var a,o=new google.maps.LatLngBounds,t=0;a=e[t];t++)new google.maps.Marker({map:map,zoom:parseInt(nooGmapL10n.zoom),title:a.name,position:a.geometry.location}),o.extend(a.geometry.location);map.fitBounds(o),map.setZoom(parseInt(nooGmapL10n.zoom))}});var s={content:document.createElement("div"),disableAutoPan:!0,maxWidth:500,boxClass:"myinfobox",zIndex:null,closeBoxMargin:"-13px 0px 0px 0px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:!1,pane:"floatPane",enableEventPropagation:!1};infoBox=new InfoBox(s);var p=function(e){var a='<div class="gmap-infobox"><a class="info-close" onclick="return infoBox.close();" href="javascript:void(0)">x</a>\t\t\t\t\t <div class="info-img"><a href="'+e.url+'">'+e.image+'</a></div> \t\t\t\t\t\t <div class="info-summary"> \t\t\t\t\t\t \t<h5 class="info-title"><a href="'+e.url+'">'+e.title+"</a></h5>";""!=e.info_summary&&(a+=e.info_summary),a+='<div class="info-more"> \t\t\t\t\t \t\t\t<div class="info-price">'+e.price_html+'</div> \t\t\t\t\t \t\t\t<div class="info-action"><a href="'+e.url+'"><i class="fa fa-plus"></i></a></div> \t\t\t\t\t \t\t</div> \t\t\t\t\t \t</div> \t\t\t\t \t</div>',infoBox.setContent(a),infoBox.open(map,e),map.setCenter(e.position),map.panBy(50,-120)};if("IDX"==w(e).data("source"))if("object"!=typeof dsidx||w.isEmptyObject(dsidx.dataSets))for(d=0;d<Noo_Source_IDX.length;d++)f=(b=Noo_Source_IDX[d]).noo_property_bedrooms,h=b.noo_property_bathrooms,_=parseFloat(b.Price.replace(/[^\d.]/g,"")),y=new google.maps.LatLng(b.Latitude,b.Longitude),(k=new google.maps.Marker({position:y,map:map,area:b.noo_property_area,image:b.image,title:b.title,bedrooms:f,bathrooms:h,info_summary:b.info_summary,price:_,price_html:b.Price,url:b.url})).setIcon(nooGmapL10n.theme_uri+"/assets/images/marker-icon.png"),gmarkers.push(k),M(k,c)&&(m.extend(k.getPosition()),nooGmapL10n.fitbounds&&map.fitBounds(m)),google.maps.event.addListener(k,"click",function(e){p(this)});else{var l=null,m=new google.maps.LatLngBounds,c=P();w.each(dsidx.dataSets,function(e,a){l=e});for(var d=0;d<dsidx.dataSets[l].length;d++){if(void 0!==(b=dsidx.dataSets[l][d]).ShortDescription)var g=b.ShortDescription.split(","),u=g[0]+", "+g[1];else u=b.Address+", "+b.City;var f=parseInt(b.BedsShortString.charAt(0)),h=parseInt(b.BathsShortString.charAt(0)),_=parseFloat(b.Price.replace(/[^\d.]/g,"")),v='<div class="info-detail"><div class="bedrooms"><span class="property-meta-icon" style="background-image: url('+NooPropertyMap.icon_bedrooms+');"></span><span class="property-meta">'+f+'</span></div><div class="bathrooms"><span class="property-meta-icon" style="background-image: url('+NooPropertyMap.icon_bathrooms+');"></span><span class="property-meta">'+h+'</span></div><div class="area"><span class="property-meta-icon" style="background-image: url('+NooPropertyMap.icon_area+');"></span><span class="property-meta">'+b.ImprovedSqFt+" "+nooGmapL10n.area_unit+"</span></div></div>",y=new google.maps.LatLng(b.Latitude,b.Longitude);(k=new google.maps.Marker({position:y,map:map,area:b.ImprovedSqFt+" "+nooGmapL10n.area_unit,image:'<img src="'+b.PhotoUriBase+b.PhotoFileName+'" />',title:u,bedrooms:f,bathrooms:h,info_summary:v,price:_,price_html:b.Price,url:nooGmapL10n.home_url+"/idx/"+b.PrettyUriForUrl})).setIcon(nooGmapL10n.theme_uri+"/assets/images/marker-icon.png"),gmarkers.push(k),M(k,c)&&(m.extend(k.getPosition()),nooGmapL10n.fitbounds&&map.fitBounds(m)),google.maps.event.addListener(k,"click",function(e){p(this)})}}else{var x=w.parseJSON(nooGmapL10n.markers);if(x.length)for(m=new google.maps.LatLngBounds,c=P(),d=0;d<x.length;d++){var b=x[d],N=(y=new google.maps.LatLng(b.latitude,b.longitude),{position:new google.maps.LatLng(b.latitude,b.longitude),map:map});w.extend(N,b);var k=new google.maps.Marker({position:y,map:map,image:b.image,title:b.title,area:b.area,bedrooms:b.bedrooms,agent_search:b.agent_search,bathrooms:b.bathrooms,price:b.price,price_html:b.price_html,info_summary:b.info_summary,url:b.url,category:b.category,status:b.status,sub_location:b.sub_location,location:b.location,year_built:b.year_built});""!=b.icon&&k.setIcon(b.icon),gmarkers.push(k),M(k,c)&&(m.extend(k.getPosition()),nooGmapL10n.fitbounds&&map.fitBounds(m)),google.maps.event.addListener(k,"click",function(e){p(this)})}}var L=[{textColor:"#ffffff",opt_textColor:"#ffffff",url:nooGmapL10n.theme_uri+"/assets/images/cloud.png",height:72,width:72,textSize:15}];mcluster=new MarkerClusterer(map,gmarkers,{gridSize:50,ignoreHidden:!0,styles:L,maxZoom:20}),google.maps.event.addListener(mcluster,"clusterclick",function(e){map.setCenter(e.getCenter()),map.setZoom(map.getZoom()+3)}),mapSearchBox.find(".zoom-in").length&&google.maps.event.addDomListener(mapSearchBox.find(".zoom-in").get(0),"click",function(e){e.stopPropagation(),e.preventDefault();var a=parseInt(map.getZoom(),10);20<++a&&(a=20),map.setZoom(a)}),mapSearchBox.find(".zoom-out").length&&google.maps.event.addDomListener(mapSearchBox.find(".zoom-out").get(0),"click",function(e){e.stopPropagation(),e.preventDefault();var a=parseInt(map.getZoom(),10);--a<0&&(a=0),map.setZoom(a)}),w(".gsearch").length&&(w(".gsearch").find(".dropdown-menu > li > a").on("click",function(e){e.stopPropagation(),e.preventDefault();var a=w(this).closest(".dropdown"),o=w(this).data("value");a.children("input").val(o),a.children("input").trigger("change"),a.children('[data-toggle="dropdown"]').text(w(this).text()),a.children('[data-toggle="dropdown"]').dropdown("toggle")}),w(".noo-map").length&&w(".noo-map").each(function(){w(this).hasClass("no-gmap")||w(this).find(".gsearch").find(".gsearch-field").find(":input").on("change",function(){w(".noo_advanced_search_property").each(function(){var e=w(this);if(e.find("#gmap").length){var a=P();null!=infoBox&&infoBox.close();var o=new google.maps.LatLngBounds;void 0!==mcluster&&mcluster.setIgnoreHidden(!0);var t=0;if(gmarkers.length){for(var n=0;n<gmarkers.length;n++){var r=gmarkers[n];M(r,a)&&(o.extend(r.getPosition()),t++)}void 0!==mcluster&&mcluster.repaint(),0<t?w(".show-filter-property").html(NooPropertyMap.results_search.replace("%d",t)).css("display","inline-block").removeClass("not_found"):w(".show-filter-property").html(NooPropertyMap.no_results_search).css("display","inline-block").addClass("not_found")}map.setZoom(10),o.isEmpty()||map.fitBounds(o)}})})}))}}),w(document).on("click",".gmap-mylocation",function(e){e.stopPropagation(),e.preventDefault(),navigator.geolocation?navigator.geolocation.getCurrentPosition(a,o,{timeout:1e4}):alert(nooGmapL10n.no_geolocation_msg)}),w(document).on("click",".gmap-full",function(e){e.stopPropagation(),e.preventDefault(),w(this).closest(".noo-map").hasClass("fullscreen")?(w(this).closest(".noo-map").removeClass("fullscreen"),w(this).empty().html('<i class="fa fa-expand"></i> '+nooGmapL10n.fullscreen_label),Modernizr.touch&&map.setOptions({draggable:!1})):(w(this).closest(".noo-map").addClass("fullscreen"),w(this).empty().html('<i class="fa fa-compress"></i> '+nooGmapL10n.default_label),Modernizr.touch&&map.setOptions({draggable:!0})),google.maps.event.trigger(map,"resize")}),w(document).on("click",".gmap-prev",function(e){for(e.stopPropagation(),e.preventDefault(),--gmarker_index<1&&(gmarker_index=gmarkers.length);!1===gmarkers[gmarker_index-1].visible;)--gmarker_index>gmarkers.length&&(gmarker_index=1);map.getZoom()<15&&map.setZoom(15),google.maps.event.trigger(gmarkers[gmarker_index-1],"click")}),w(document).on("click",".gmap-next",function(e){for(e.stopPropagation(),e.preventDefault(),++gmarker_index>gmarkers.length&&(gmarker_index=1);!1===gmarkers[gmarker_index-1].visible;)++gmarker_index>gmarkers.length&&(gmarker_index=1);map.getZoom()<15&&map.setZoom(15),google.maps.event.trigger(gmarkers[gmarker_index-1],"click")}),google.maps.event.addDomListener(window,"load",function(){var s,e=w(".property-map-box"),a=e.data("zoom"),o=e.data("latitude"),t=e.data("longitude"),n=e.data("marker");if(e.length){var p=new google.maps.LatLng(o,t),l=new google.maps.Map(e.get(0),{flat:!1,noClear:!1,zoom:a,scrollwheel:!1,draggable:!Modernizr.touch&&nooGmapL10n.draggable,center:p,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP});""==n&&(n=nooGmapL10n.theme_uri+"/assets/images/marker-icon.png"),n=new google.maps.Marker({icon:n,position:p,map:l});var m=document.getElementById("property_map_search_input");l.controls[google.maps.ControlPosition.TOP_LEFT].push(m);var r=new google.maps.places.SearchBox(m);google.maps.event.addListener(r,"places_changed",function(){null!=s&&s.setMap(null);var e,a=new google.maps.Geocoder;e=p,a.geocode({latLng:e},function(e,a){if(a==google.maps.GeocoderStatus.OK&&e[0])return e[0].formatted_address}),a.geocode({address:m.value},function(e,a){if(a==google.maps.GeocoderStatus.OK){l.setCenter(e[0].geometry.location),s=new google.maps.Marker({position:e[0].geometry.location,map:l,draggable:!1,animation:google.maps.Animation.DROP});var o=m.value,t=p,n=new google.maps.DirectionsService,r=new google.maps.DirectionsRenderer;r.setMap(l);var i={origin:o,destination:t,travelMode:google.maps.TravelMode.DRIVING};n.route(i,function(e,a){a==google.maps.DirectionsStatus.OK&&r.setDirections(e)})}else alert("Geocode was not successful for the following reason: "+a)})})}}),jQuery(document).ready(function(t){0<t(".noo-map").length&&0<t(".show-filter-property").length&&0<t(".noo-map").find("#gmap").length&&0==t(".results-property-map").length&&t(".show-filter-property").click(function(e){if(!t(this).hasClass("not_found")&&t(".container-wrap > .noo_advanced_search_property").length){e.preventDefault(),t(".noo-main").html('<div class="noo-loading-property"><img alt="" src="'+NooPropertyMap.loading+'" /></div><div class="results-property"></div>');var a=n(t(".gsearchform").first());a.action="filter_property_map",a.security=NooPropertyMap.security,t.ajax({url:NooPropertyMap.ajax_url,type:"POST",dataType:"html",cache:!1,data:a,beforeSend:function(e){t(".noo-loading-property").show(),t(".results-property").html("");var a=95;if(0<t(".navbar-fixed-top.navbar").length)a=a+t(".navbar-fixed-top.navbar").height();if(0<t("#wpadminbar").length)a=a+t("#wpadminbar").height();t("html, body").animate({scrollTop:t(".noo-loading-property").offset().top-a},"slow")},complete:function(){t(".noo-loading-property").hide()}}).done(function(e){t(".results-property").html(e)}).fail(function(){console.log("error")})}}),0<t(".results-property-map").length&&(t(".results-property-map").prepend('<div class="noo-loading-property"><img alt="" src="'+NooPropertyMap.loading+'" /></div><div class="results-map-property"></div>'),t(".gsearchform").find(".gsearch-field").find(":input").on("change",function(){var e=n(t(".gsearchform"));e.action="filter_property_map",e.security=NooPropertyMap.security,e.hide_head=!0,e.hide_orderby=!0,t.ajax({url:NooPropertyMap.ajax_url,type:"POST",dataType:"html",cache:!1,data:e,beforeSend:function(e){t(".noo-loading-property").show()},complete:function(){t(".noo-loading-property").hide()}}).done(function(e){t(".results-map-property").html(e),t(".results-map-property").next().remove()}).fail(function(){console.log("error")})})),t(".noo-main").on("click",".btn-loadmore",function(e){e.stopPropagation(),e.preventDefault();var a=n(t(".gsearchform").first());a.action="filter_property_map",a.security=NooPropertyMap.security,a.results="load_more",a.current_page=t(this).data("current-page");var o=t(this).data("class-wrap");t("."+o).html('<div class="noo-loading-property"><img alt="" src="'+NooPropertyMap.loading+'" /></div>'),t.ajax({url:NooPropertyMap.ajax_url,type:"POST",dataType:"html",cache:!1,data:a,beforeSend:function(){}}).done(function(e){t("."+o).remove(),t(".loadmore-wrap").append(e)}).fail(function(){console.log("error")})})})}(jQuery);